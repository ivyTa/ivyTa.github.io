## 1.3  react组件间通信

### 1.3.1 父组件 向 子组件 传递信息

1. 主要是通过 prop进行传值

// 子组件
```js
import React, {Component} from 'react'

export default class Son extends Component {
  constructor(props) {
    super(props)
    this.state = {}
  }

  render() {
    const {list} = this.props

    const option = list.map(item=><li key={item}>{item}</li>)

    return (
      <div>
        <ul>{option}</ul>
      </div>
    )
  }
}
```

// 父组件

```js
import React, {Component} from 'react'
import ReactDOM from 'react-dom'

import Son from './son'
export default class App extends Component {
  constructor(props) {
    super(props)
    this.state = {
      data:['haha','aaaa','bbbb','ccccc']
    }
  }

  render() {
    const {data} = this.state

    return(
      <div>
          <Son list={data} />
      </div>
    )
  }
}

ReactDOM.render(<App />, document.getElementById('main'))
```


2. 父组件 向更深层的 子组件 进行传递信息————利用（context）

- 首先在顶层组件中：定义了顶层组件所拥有的子类context对象——该顶层组件所拥有的的子类context对象为title，且必须为字符串。然后通过getChildText方法，来给子context对象的属性赋值；

- 越级传递：因为title属性，在一级子组件Son中并没有直接用到，因此我们可以直接传递到最底层（越级），在Grandson组件中使用；

- 最底层：声明了所接受到的context的子组件title的类型，声明必须为字符串。

// 孙子组件
```js
import React, {Component} from 'react'

export default class GrandSon extends Component {
  constructor(props) {
    super(props)
    this.state = {}
  }

  render() {

    return (
      <div>
        <h1>{this.context.title}</h1>
      </div>
    )
  }
}

GrandSon.contextTypes = {
  title: React.PropTypes.string
}
```

// 子组件
```js
import React, {Component} from 'react'
import Grandson from './grandson'

export default class Son extends Component {
  constructor(props) {
    super(props)
    this.state = {}
  }

  render() {
    const {list} = this.props

    const option = list.map(item => <li key={item}>{item}</li>)

    return (
      <div>
        <Grandson />
        <ul>{option}</ul>
      </div>
    )
  }
}
```

// 父组件
```js
import React, {Component} from 'react'
import ReactDOM from 'react-dom'

import Son from './son'
export default class App extends Component {
  constructor(props) {
    super(props)
    this.state = {
      data:['haha','aaaa','bbbb','ccccc']
    }
  }

  getChildContext() {
    return {title: "列表"};
  }

  render() {
    const {data} = this.state

    return(
      <div>
          <Son list={data} />
      </div>
    )
  }
}
App.childContextTypes = {
  title: React.PropTypes.string
};

ReactDOM.render(<App />, document.getElementById('main'))
```


### 1.3.2 子组件 向 父组件 传递信息

- 依赖 props 来传递事件的引用，并通过回调的方式来实现的;

// 子组件

```js
import React, {Component} from 'react'

export default class Son extends Component {
  constructor(props) {
    super(props)
    this.state = {
      checked: false
    }
  }

  handleChange() {
    var newState = !this.state.checked
    this.setState({
      checked: newState
    })
    this.props.changeParent(newState)
  }

  render() {

    return (
      <div>
        <label>
          选择：
          <input type='checkbox' checked={this.state.checked} onChange={this.handleChange.bind(this)}/>
        </label>
      </div>
    )
  }
}
```
// 父组件

```js
import React, {Component} from 'react'
import ReactDOM from 'react-dom'

import Son from './son'
export default class App extends Component {
  constructor(props) {
    super(props)
    this.state = {
      value: false
    }
  }

  handleChange(value) {
    console.log('value', value);
    this.setState({
      value: value
    })
  }

  render() {

    const {value} = this.state

    return (
      <div>
        <h1>是否选中: {value > 0 ? '是' : '否'}</h1>
        <Son changeParent={this.handleChange.bind(this)}/>
      </div>
    )
  }
}

ReactDOM.render(<App />, document.getElementById('main'))
```

- 在子组件利用 this.props.changeParent(newState) 触发父组件的方法，在父组件绑定changeParent={this.handleChange.bind(this)}，进而将子组件的数据（newState）传递到了父组件。


### 1.3.3 兄弟组件之间传值
















